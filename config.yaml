# workflow/config.yaml
genome: dm6   # genome label for reporting/logging

# Read type: PE (paired-end) or SE (single-end)
read_type: "PE"

threads:
  fastp: 8
  bowtie2: 16
  samtools: 8
  deeptools: 8

# Reference & index
reference:
  bowtie2_index: "/path/to/genome/bowtie2/dm6"
  chrom_sizes: "/path/to/genome/dm6.chrom.sizes"
  fasta: "/path/to/genome.fa"

# Blacklist (manual)
# Boyle-Lab blacklist repository (examples):
#   https://github.com/Boyle-Lab/Blacklist
#   https://github.com/Boyle-Lab/Blacklist/tree/master/lists
blacklist:
  cache_dir: "resources/blacklist"
  # Provide exactly one of the following:
  # path: "/path/to/custom.blacklist.bed"
  # url: "https://raw.githubusercontent.com/Boyle-Lab/Blacklist/master/lists/dm6-blacklist.v2.bed.gz"

# Enable blacklist filtering (requires blacklist.path or blacklist.url)
filter_blacklist: true

# Remove PCR duplicates
remove_duplicates: true
dedup_method: "picard"  # Options: picard, samtools

# Keep BAM outputs (.bam/.unique.bam/.filtered.bam). Default false to save space.
keep_bam: false

# Samtools filtering flags
samtools_exclude_flags: 1804  # exclude unmapped, not primary, fails QC, duplicate

# Bedtools parameters for blacklist filtering
bedtools_nonamecheck: true  # Skip chromosome name checking

# Samples: multiple technical replicates (or lanes) under one sample
samples:
  sampleA:
    R1:
      - "raw/sampleA_L001_R1.fastq.gz"
      - "raw/sampleA_L002_R1.fastq.gz"
    R2:
      - "raw/sampleA_L001_R2.fastq.gz"
      - "raw/sampleA_L002_R2.fastq.gz"

  sampleB:
    R1:
      - "raw/sampleB_R1.fastq.gz"
    R2:
      - "raw/sampleB_R2.fastq.gz"
  # For SE (single-end) input, provide only R1 entries per sample (omit R2).

# fastp settings
fastp:
  # QC + Illumina adapter trimming + dedup
  dedup_adapter:
    enable: true
    dedup: true

# bowtie2 alignment settings
bowtie2:
  max_insert_size: 500
  mode: "very-sensitive"  # Options: very-fast, fast, sensitive, very-sensitive
  keep_multimappers: false  # Set to true to keep multi-mapped reads
  mapq_threshold: 30  # Minimum MAPQ score for unique mapping
  extra: ""  # optional additional args

# Output naming
output:
  dir: "results"

# Generate summary reports
generate_multiqc: true

# Run MACS3 peak calling
run_macs3: true

# Peak Calling (MACS3)
macs:
  gsize: "dm"  # Effective genome size: hs, mm, ce, dm
  qvalue: 0.05  # Q-value cutoff
  extsize: 200  # Fragment extension size
  broad: false  # Set true for broad peak calling (H3K27me3, etc.)
  broad_cutoff: 0.1  # Broad peak cutoff (only used if macs.broad=true)

# ----------------------------------------------------------------------------
# BigWig Generation
# ----------------------------------------------------------------------------
bigwig:
  bin_size: 10  # Bin size for coverage tracks
  normalization: "RPKM"  # Options: RPKM, CPM, BPM, RPGC, None
  samtools_exclude_flags: 1804  # Default: exclude unmapped, secondary, QC fail, duplicates
  remove_chrM_and_scaffolds: true  # Exclude chrM/MT/M and scaffold-like contigs for bigWig

# Generate both normalized and unnormalized bigWig files
generate_raw_bigwig: true
generate_normalized_bigwig: true
